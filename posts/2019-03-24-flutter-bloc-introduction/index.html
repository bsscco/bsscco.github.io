<!DOCTYPE html>
<html lang="">
<head>
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <script type="text/javascript" src="https://latest.cactus.chat/cactus.js"></script>
  <link rel="stylesheet" href="https://latest.cactus.chat/style.css" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title> Flutter로 개발하기(22) - Bloc 소개 | ANDROID DEVELOPER BSSCCO</title>
  <link rel = 'canonical' href = '/posts/2019-03-24-flutter-bloc-introduction/'>
  
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="robots" content="all,follow">
  <meta name="googlebot" content="index,follow,snippet,archive">
  <meta property="og:title" content="Flutter로 개발하기(22) - Bloc 소개" />
<meta property="og:description" content="Bloc document - 소개 원문: https://felangel.github.io/bloc
시작하기 개요 Bloc은 세 가지 패키지로 구성됩니다.
bloc - 코어 라이브러리 flutter_bloc - bloc을 사용하기 위한 플러터 위젯 angular_bloc - bloc을 사용하기 위한 앵귤러 컴포넌트 설치 플터터의 경우 pubspec.yaml에서
dependencies: bloc: ^0.10.0 flutter_bloc: ^0.8.0 그리고 flutter packages get
Import 플러터의 경우
import &#39;package:bloc/bloc.dart&#39;; import &#39;package:flutter_bloc/flutter_bloc.dart&#39;; 왜 Bloc인가요? Bloc은 비지니스 로직으로부터 프리젠테이션 로직을 쉽게 분리시켜줍니다. 빠르게 작성할 수 있는 코드, 쉽게 테스트 할 수 있는 코드, 재사용 가능한 코드를 만들 수 있게 해줍니다." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/2019-03-24-flutter-bloc-introduction/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-03-24T09:51:41+00:00" />
<meta property="article:modified_time" content="2019-03-24T09:51:41+00:00" />


  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Flutter로 개발하기(22) - Bloc 소개"/>
<meta name="twitter:description" content="Bloc document - 소개 원문: https://felangel.github.io/bloc
시작하기 개요 Bloc은 세 가지 패키지로 구성됩니다.
bloc - 코어 라이브러리 flutter_bloc - bloc을 사용하기 위한 플러터 위젯 angular_bloc - bloc을 사용하기 위한 앵귤러 컴포넌트 설치 플터터의 경우 pubspec.yaml에서
dependencies: bloc: ^0.10.0 flutter_bloc: ^0.8.0 그리고 flutter packages get
Import 플러터의 경우
import &#39;package:bloc/bloc.dart&#39;; import &#39;package:flutter_bloc/flutter_bloc.dart&#39;; 왜 Bloc인가요? Bloc은 비지니스 로직으로부터 프리젠테이션 로직을 쉽게 분리시켜줍니다. 빠르게 작성할 수 있는 코드, 쉽게 테스트 할 수 있는 코드, 재사용 가능한 코드를 만들 수 있게 해줍니다."/>

  
  
    
  
  
  <link rel="stylesheet" href="/css/styles.21b53826999b56f614a462e7379896ede73d74a5692c12b28e7903a2718c278b00eb8c5d88fef06d852fd6311822698ff8397102b0517b964d57892b541fb785.css" integrity="sha512-IbU4JpmbVvYUpGLnN5iW7ec9dKVpLBKyjnkDonGMJ4sA64xdiP7wbYUv1jEYImmP&#43;DlxArBRe5ZNV4krVB&#43;3hQ=="> 

  
  
  
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  

  
<link rel="icon" type="image/png" href="images/favicon.ico" />

  
  
</head>

<body class="max-width mx-auto px3 ltr">
  <div class="content index py4">

  <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;" aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
        <li><a href="/posts">Posts</a></li>
         
        <li><a href="/categories">Categories</a></li>
         
        <li><a href="/tags">Tags</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li>
          <a class="icon" href=" /posts/2019-03-23-flutter-bloc-library-sample/" aria-label="Previous">
            <i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i>
          </a>
        </li>
        
        
        <li>
          <a class="icon" href="/posts/2019-03-25-flutter-bloc-tutorials/" aria-label="Next">
            <i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i>
          </a>
        </li>
        
        <li>
          <a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" aria-label="Top of Page">
            <i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i>
          </a>
        </li>
        <li>
          <a class="icon" href="#" aria-label="Share">
            <i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i>
          </a>
        </li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=%2fposts%2f2019-03-24-flutter-bloc-introduction%2f" aria-label="Facebook">
      <i class="fab fa-facebook " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=%2fposts%2f2019-03-24-flutter-bloc-introduction%2f&text=Flutter%eb%a1%9c%20%ea%b0%9c%eb%b0%9c%ed%95%98%ea%b8%b0%2822%29%20-%20Bloc%20%ec%86%8c%ea%b0%9c" aria-label="Twitter">
      <i class="fab fa-twitter " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=%2fposts%2f2019-03-24-flutter-bloc-introduction%2f&title=Flutter%eb%a1%9c%20%ea%b0%9c%eb%b0%9c%ed%95%98%ea%b8%b0%2822%29%20-%20Bloc%20%ec%86%8c%ea%b0%9c" aria-label="Linkedin">
      <i class="fab fa-linkedin " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=%2fposts%2f2019-03-24-flutter-bloc-introduction%2f&is_video=false&description=Flutter%eb%a1%9c%20%ea%b0%9c%eb%b0%9c%ed%95%98%ea%b8%b0%2822%29%20-%20Bloc%20%ec%86%8c%ea%b0%9c" aria-label="Pinterest">
      <i class="fab fa-pinterest " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=Flutter%eb%a1%9c%20%ea%b0%9c%eb%b0%9c%ed%95%98%ea%b8%b0%2822%29%20-%20Bloc%20%ec%86%8c%ea%b0%9c&body=Check out this article: %2fposts%2f2019-03-24-flutter-bloc-introduction%2f" aria-label="Email">
      <i class="fas fa-envelope " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=%2fposts%2f2019-03-24-flutter-bloc-introduction%2f&title=Flutter%eb%a1%9c%20%ea%b0%9c%eb%b0%9c%ed%95%98%ea%b8%b0%2822%29%20-%20Bloc%20%ec%86%8c%ea%b0%9c" aria-label="Pocket">
      <i class="fab fa-get-pocket " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=%2fposts%2f2019-03-24-flutter-bloc-introduction%2f&title=Flutter%eb%a1%9c%20%ea%b0%9c%eb%b0%9c%ed%95%98%ea%b8%b0%2822%29%20-%20Bloc%20%ec%86%8c%ea%b0%9c" aria-label="reddit">
      <i class="fab fa-reddit " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=%2fposts%2f2019-03-24-flutter-bloc-introduction%2f&name=Flutter%eb%a1%9c%20%ea%b0%9c%eb%b0%9c%ed%95%98%ea%b8%b0%2822%29%20-%20Bloc%20%ec%86%8c%ea%b0%9c&description=Bloc%20document%20-%20%ec%86%8c%ea%b0%9c%20%ec%9b%90%eb%ac%b8%3a%20https%3a%2f%2ffelangel.github.io%2fbloc%0a%ec%8b%9c%ec%9e%91%ed%95%98%ea%b8%b0%20%ea%b0%9c%ec%9a%94%20Bloc%ec%9d%80%20%ec%84%b8%20%ea%b0%80%ec%a7%80%20%ed%8c%a8%ed%82%a4%ec%a7%80%eb%a1%9c%20%ea%b5%ac%ec%84%b1%eb%90%a9%eb%8b%88%eb%8b%a4.%0abloc%20-%20%ec%bd%94%ec%96%b4%20%eb%9d%bc%ec%9d%b4%eb%b8%8c%eb%9f%ac%eb%a6%ac%20flutter_bloc%20-%20bloc%ec%9d%84%20%ec%82%ac%ec%9a%a9%ed%95%98%ea%b8%b0%20%ec%9c%84%ed%95%9c%20%ed%94%8c%eb%9f%ac%ed%84%b0%20%ec%9c%84%ec%a0%af%20angular_bloc%20-%20bloc%ec%9d%84%20%ec%82%ac%ec%9a%a9%ed%95%98%ea%b8%b0%20%ec%9c%84%ed%95%9c%20%ec%95%b5%ea%b7%a4%eb%9f%ac%20%ec%bb%b4%ed%8f%ac%eb%84%8c%ed%8a%b8%20%ec%84%a4%ec%b9%98%20%ed%94%8c%ed%84%b0%ed%84%b0%ec%9d%98%20%ea%b2%bd%ec%9a%b0%20pubspec.yaml%ec%97%90%ec%84%9c%0adependencies%3a%20bloc%3a%20%5e0.10.0%20flutter_bloc%3a%20%5e0.8.0%20%ea%b7%b8%eb%a6%ac%ea%b3%a0%20flutter%20packages%20get%0aImport%20%ed%94%8c%eb%9f%ac%ed%84%b0%ec%9d%98%20%ea%b2%bd%ec%9a%b0%0aimport%20%26%2339%3bpackage%3abloc%2fbloc.dart%26%2339%3b%3b%20import%20%26%2339%3bpackage%3aflutter_bloc%2fflutter_bloc.dart%26%2339%3b%3b%20%ec%99%9c%20Bloc%ec%9d%b8%ea%b0%80%ec%9a%94%3f%20Bloc%ec%9d%80%20%eb%b9%84%ec%a7%80%eb%8b%88%ec%8a%a4%20%eb%a1%9c%ec%a7%81%ec%9c%bc%eb%a1%9c%eb%b6%80%ed%84%b0%20%ed%94%84%eb%a6%ac%ec%a0%a0%ed%85%8c%ec%9d%b4%ec%85%98%20%eb%a1%9c%ec%a7%81%ec%9d%84%20%ec%89%bd%ea%b2%8c%20%eb%b6%84%eb%a6%ac%ec%8b%9c%ec%bc%9c%ec%a4%8d%eb%8b%88%eb%8b%a4.%20%eb%b9%a0%eb%a5%b4%ea%b2%8c%20%ec%9e%91%ec%84%b1%ed%95%a0%20%ec%88%98%20%ec%9e%88%eb%8a%94%20%ec%bd%94%eb%93%9c%2c%20%ec%89%bd%ea%b2%8c%20%ed%85%8c%ec%8a%a4%ed%8a%b8%20%ed%95%a0%20%ec%88%98%20%ec%9e%88%eb%8a%94%20%ec%bd%94%eb%93%9c%2c%20%ec%9e%ac%ec%82%ac%ec%9a%a9%20%ea%b0%80%eb%8a%a5%ed%95%9c%20%ec%bd%94%eb%93%9c%eb%a5%bc%20%eb%a7%8c%eb%93%a4%20%ec%88%98%20%ec%9e%88%ea%b2%8c%20%ed%95%b4%ec%a4%8d%eb%8b%88%eb%8b%a4." aria-label="Tumblr">
      <i class="fab fa-tumblr " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=%2fposts%2f2019-03-24-flutter-bloc-introduction%2f&t=Flutter%eb%a1%9c%20%ea%b0%9c%eb%b0%9c%ed%95%98%ea%b8%b0%2822%29%20-%20Bloc%20%ec%86%8c%ea%b0%9c" aria-label="Hacker News">
      <i class="fab fa-hacker-news " aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>
    
    <div id="toc">
      <nav id="TableOfContents">
  <ul>
    <li><a href="#시작하기">시작하기</a>
      <ul>
        <li><a href="#개요">개요</a></li>
        <li><a href="#설치">설치</a></li>
        <li><a href="#import">Import</a></li>
      </ul>
    </li>
    <li><a href="#왜-bloc인가요">왜 Bloc인가요?</a></li>
    <li><a href="#핵심-개념">핵심 개념</a>
      <ul>
        <li><a href="#events">Events</a></li>
        <li><a href="#states">States</a></li>
        <li><a href="#transitions">Transitions</a></li>
        <li><a href="#streams">Streams</a></li>
        <li><a href="#blocs">Blocs</a></li>
        <li><a href="#blocdelegate">BlocDelegate</a></li>
      </ul>
    </li>
    <li><a href="#아키텍쳐">아키텍쳐</a>
      <ul>
        <li><a href="#데이터-레이어">데이터 레이어</a></li>
        <li><a href="#blocbusiness-logic-레이어">Bloc(Business Logic) 레이어</a></li>
        <li><a href="#프리젠테이션-레이어">프리젠테이션 레이어</a></li>
      </ul>
    </li>
    <li><a href="#테스팅">테스팅</a></li>
  </ul>
</nav>
    </div>
    
  </span>
</div>


  <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
    <header>
      <h1 class="posttitle" itemprop="name headline">
        Flutter로 개발하기(22) - Bloc 소개
      </h1>
      <div class="meta">
        
        <div class="postdate">
          
          <time datetime="2019-03-24 09:51:41 &#43;0000 UTC" itemprop="datePublished">2019-03-24</time>
          
        </div>
        
        
        
        <div class="article-category">
            <i class="fas fa-archive"></i>
            
            
            <a class="category-link" href="/categories/android">Android</a>
            
        </div>
        
        
        <div class="article-tag">
            <i class="fas fa-tag"></i>
            
            
            <a class="tag-link" href="/tags/flutter" rel="tag">flutter</a>
            
             ,  
            <a class="tag-link" href="/tags/bloc" rel="tag">bloc</a>
            
        </div>
        
      </div>
    </header>

  
    
    <div class="content" itemprop="articleBody">
      <h1 id="bloc-document---소개">Bloc document - 소개</h1>
<p>원문: <a href="https://felangel.github.io/bloc">https://felangel.github.io/bloc</a></p>
<h2 id="시작하기">시작하기</h2>
<h3 id="개요">개요</h3>
<p>Bloc은 세 가지 패키지로 구성됩니다.</p>
<ul>
<li>bloc - 코어 라이브러리</li>
<li>flutter_bloc - bloc을 사용하기 위한 플러터 위젯</li>
<li>angular_bloc - bloc을 사용하기 위한 앵귤러 컴포넌트</li>
</ul>
<h3 id="설치">설치</h3>
<p>플터터의 경우 pubspec.yaml에서</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">dependencies</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">bloc</span>: <span style="color:#ae81ff">^0.10.0</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">flutter_bloc</span>: <span style="color:#ae81ff">^0.8.0</span>
</span></span></code></pre></div><p>그리고 <code>flutter packages get</code></p>
<h3 id="import">Import</h3>
<p>플러터의 경우</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#ae81ff">import &#39;package:bloc/bloc.dart&#39;;</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">import &#39;package:flutter_bloc/flutter_bloc.dart&#39;;</span>
</span></span></code></pre></div><h2 id="왜-bloc인가요">왜 Bloc인가요?</h2>
<blockquote>
<p>Bloc은 비지니스 로직으로부터 프리젠테이션 로직을 쉽게 분리시켜줍니다. 빠르게 작성할 수 있는 코드, 쉽게 테스트 할 수 있는 코드, 재사용 가능한 코드를 만들 수 있게 해줍니다.</p>
</blockquote>
<p>프로덕션 퀄리티의 앱을 제작할 때 상태관리는 매우 중요합니다.</p>
<p>우리는 개발자로써 이런 것들을 원합니다:</p>
<ul>
<li>우리 앱의 상태가 어느 시점에 어떤 상태에 있는지 알기 원합니다.</li>
<li>우리 앱이 적절하게 반응하고 있는지 확인할 모든 케이스를 쉽게 테스트할 수 있길 원합니다.</li>
<li>모든 단일 사용자 상호작용을 기록하기 원합니다. 그렇게 되면 데이터 기반이 의사결정이 가능해집니다.</li>
<li>컴포넌트 재사용을 통해 가능한 한 효과적으로 일하기 원합니다.</li>
<li>많은 개발자들이 같은 패턴, 같은 컨벤션을 따라서 끊김없이 일하기 원합니다.</li>
<li>빠른 반응형 앱을 만들기 원합니다.</li>
</ul>
<p>Bloc은 이러한 니즈 이상의 것들을 고려해서 설계됐습니다.</p>
<p>Bloc은 세 가지 핵심 가치와 함께 설계됐습니다.</p>
<ul>
<li>단순함
<ul>
<li>다양한 스킬의 개발자들에 의해 사용될 수 있고 이해하기 쉽습니다.</li>
</ul>
</li>
<li>강력함
<ul>
<li>작은 컴포넌트들을 구성해서 훨씬 복잡한 앱을 만들 수 있습니다.</li>
</ul>
</li>
<li>테스트 가능
<ul>
<li>앱의 모든 측면에서 테스트하기 쉽습니다.</li>
</ul>
</li>
</ul>
<p>Bloc은 상태변경이 일어날 수 있는 시기를 규제하고 상태변경의 방법을 하나로 강제함으로써 상태변경을 예측할 수 있게 해줍니다.</p>
<h2 id="핵심-개념">핵심 개념</h2>
<h3 id="events">Events</h3>
<blockquote>
<p>Events는 Bloc으로 향하는 입력입니다. 그들은 일반적으로 버튼눌림 같은 사용자 상호작용, 페이지로드 같은 라이프사이클 이벤트에 의해 디스패치됩니다.</p>
</blockquote>
<p>카운터앱에서 두 버튼 중 하나를 눌렀을 때 발생하는 이벤트</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dart" data-lang="dart"><span style="display:flex;"><span>enum CounterEvent { increment, decrement }
</span></span></code></pre></div><p>여기서는 enum을 사용해 이벤트를 정의했지만, 더 복잡한 경우엔 class로 정의해야 할 수도 있습니다.</p>
<h3 id="states">States</h3>
<blockquote>
<p>States는 Bloc의 출력입니다. 그리고 앱의 상태를 대표합니다. UI 컴포넌트들은 상태를 공지받을 수 있고, 그 상태를 기반으로 다시 그릴 수 있습니다.</p>
</blockquote>
<p>카운터앱에서 상태는 아주 단순합니다. 이 상태는 integer이고, 현재 카운트를 대표합니다.</p>
<h3 id="transitions">Transitions</h3>
<blockquote>
<p>한 상태에서 또 다른 상태로의 변경을 Transition이라고 부릅니다. Transition은 현재 상태, 이벤트, 다음 상태로 구성됩니다.</p>
</blockquote>
<p>사용자가 카운터과 상호작용 함으로써 Increment 또는 Decrement 이벤트가 트리거되고,  그 이벤트는 현재 상태를 갱신시킬 것입니다. 이런 상태변경을 Transition으로 설명할 수 있습니다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dart" data-lang="dart"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;currentState&#34;</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;event&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;CounterEvent.increment&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;nextState&#34;</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>모든 상태변경은 기록되기 때문에 우리는 쉽게 사용자의 모든 상호작용을 추적할 수 있습니다. 추가적으로 디버깅에서 시간여행 기능을 만들 수도 있습니다.</p>
<h3 id="streams">Streams</h3>
<blockquote>
<p>Stream은 비동기 데이터의 나열입니다.</p>
</blockquote>
<p>Bloc은 RxDart 위에 빌드되었습니다.</p>
<h3 id="blocs">Blocs</h3>
<blockquote>
<p>Bloc은 Events의 입력 Stream을 States의 출력 Stream으로 변시켜주는 컴포넌트입니다.</p>
</blockquote>
<p>모든 Bloc은 <code>Bloc</code> 클래스를 상속해야 합니다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dart" data-lang="dart"><span style="display:flex;"><span><span style="color:#66d9ef">import</span> <span style="color:#e6db74">&#39;package:bloc/bloc.dart&#39;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">CounterBloc</span> <span style="color:#66d9ef">extends</span> Bloc<span style="color:#f92672">&lt;</span>CounterEvent, <span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>모든 Bloc은 처음 상태를 정의해야 합니다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dart" data-lang="dart"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">@</span>override
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#66d9ef">get</span> initialState <span style="color:#f92672">=&gt;</span> <span style="color:#ae81ff">0</span>;
</span></span></code></pre></div><p>모든 Bloc은 mapEventToState() 함수를 구현해야 합니다. 이 함수는 currentState, event 두 인자를 취해서 프리젠테이션 레이어에서 소비될 새로운 상태의 Stream을 반환합니다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dart" data-lang="dart"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">@</span>override
</span></span><span style="display:flex;"><span>Stream<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> mapEventToState(<span style="color:#66d9ef">int</span> currentState, CounterEvent event) <span style="color:#66d9ef">async</span><span style="color:#f92672">*</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">switch</span> (event) {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">case</span> CounterEvent.decrement:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">yield</span> currentState <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">case</span> CounterEvent.increment:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">yield</span> currentState <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><code>CounterBloc</code>의 완전한 코드</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dart" data-lang="dart"><span style="display:flex;"><span><span style="color:#66d9ef">import</span> <span style="color:#e6db74">&#39;package:bloc/bloc.dart&#39;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>enum CounterEvent { increment, decrement }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">CounterBloc</span> <span style="color:#66d9ef">extends</span> Bloc<span style="color:#f92672">&lt;</span>CounterEvent, <span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#960050;background-color:#1e0010">@</span>override
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">int</span> <span style="color:#66d9ef">get</span> initialState <span style="color:#f92672">=&gt;</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#960050;background-color:#1e0010">@</span>override
</span></span><span style="display:flex;"><span>  Stream<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> mapEventToState(<span style="color:#66d9ef">int</span> currentState, CounterEvent event) <span style="color:#66d9ef">async</span><span style="color:#f92672">*</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">switch</span> (event) {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">case</span> CounterEvent.decrement:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">yield</span> currentState <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">case</span> CounterEvent.increment:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">yield</span> currentState <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Bloc이 반환한 새 상태가 현재 상태와 같다면 Transition은 발생하지 않습니다.</p>
<p>모든 Bloc은 dispatch 메소드를 가집니다. Dispatch는 event를 취해서 mapEventToState를 트리거 합니다. Dispatch는 프리젠테이션 레이어에서 호출되거나 Bloc 안에서 새로운 이벤트로 그 Bloc에게 알리기 위해 호출될 것입니다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dart" data-lang="dart"><span style="display:flex;"><span><span style="color:#66d9ef">void</span> main() {
</span></span><span style="display:flex;"><span>    CounterBloc bloc <span style="color:#f92672">=</span> CounterBloc();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">3</span>; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>        bloc.dispatch(CounterEvent.increment);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>위 코드에서 Transition들은 다음과 같습니다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dart" data-lang="dart"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;currentState&#34;</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;event&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;CounterEvent.increment&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;nextState&#34;</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;currentState&#34;</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;event&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;CounterEvent.increment&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;nextState&#34;</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;currentState&#34;</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">2</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;event&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;CounterEvent.increment&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;nextState&#34;</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>onTransition은 모든 지역 Bloc transition을 다루기 위해 오버라이드 할 수 있는 메소드입니다. onTransition은 Bloc의 상태가 변경되기 전에 호출됩니다.</p>
<p>Tip: onTransition은 Bloc의 로깅과 분석 코드를 추가하기 좋은 위치입니다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dart" data-lang="dart"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">@</span>override
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> onTransition(Transition<span style="color:#f92672">&lt;</span>CounterEvent, <span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> transition) {
</span></span><span style="display:flex;"><span>    print(transition);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>onError는 모든 지역 Bloc 예외를 다루기 위해 오버라이드 할 수 있는 메소드입니다. 기본적으로 모든 예외는 무시되고, Bloc의 기능은 영향을 받지 않을 것입니다.</p>
<p>Tip: onError는 에러 핸들링 코드를 추가하기 좋은 위치입니다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dart" data-lang="dart"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">@</span>override
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> onError(<span style="color:#66d9ef">Object</span> error, StackTrace stackTrace) {
</span></span><span style="display:flex;"><span>  print(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">$</span>error<span style="color:#e6db74">, </span><span style="color:#e6db74">$</span>stackTrace<span style="color:#e6db74">&#39;</span>);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="blocdelegate">BlocDelegate</h3>
<p>모든 Trasition, Exception들에 접근할 수 있는 보너스가 있습니다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dart" data-lang="dart"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SimpleBlocDelegate</span> <span style="color:#66d9ef">extends</span> BlocDelegate {
</span></span><span style="display:flex;"><span>  <span style="color:#960050;background-color:#1e0010">@</span>override
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">void</span> onTransition(Transition transition) {
</span></span><span style="display:flex;"><span>    print(transition);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#960050;background-color:#1e0010">@</span>override
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">void</span> onError(<span style="color:#66d9ef">Object</span> error, StackTrace stacktrace) {
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">$</span>error<span style="color:#e6db74">, </span><span style="color:#e6db74">$</span>stacktrace<span style="color:#e6db74">&#39;</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">----------------------------------------</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> main() {
</span></span><span style="display:flex;"><span>  BlocSupervisor().delegate <span style="color:#f92672">=</span> SimpleBlocDelegate();
</span></span><span style="display:flex;"><span>  CounterBloc bloc <span style="color:#f92672">=</span> CounterBloc();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">3</span>; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>    bloc.dispatch(CounterEvent.increment);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>BlocSupervisor는 모든 Bloc을 감독하는 싱글톤 객체입니다.</p>
<h2 id="아키텍쳐">아키텍쳐</h2>
<p><img src="https://miro.medium.com/max/1400/1*_EgLk67LpREOEMCSIhc_4Q.png" alt="bloc-architecture.png">
Bloc을 사용함으로써 우리 앱을 세 가지 레이어로 분리시킬 수 있습니다.</p>
<ul>
<li>데이터
<ul>
<li>Data Provider</li>
<li>Repository</li>
</ul>
</li>
<li>비지니스 로직</li>
<li>프리젠테이션</li>
</ul>
<p>더 lowest level(UI에서 가장 먼)에서 시작해서 프리젠테이션 레이어를 향해 위 방향으로 작업할 것입니다.</p>
<h3 id="데이터-레이어">데이터 레이어</h3>
<blockquote>
<p>데이터 레이어는 하나 또는 여러 source들로부터 데이터를 찾고 조작하는 책임을 집니다.</p>
</blockquote>
<h4 id="data-provider">Data Provider</h4>
<p>Data Provider의 책임은 raw 데이터를 제공하는 것입니다. Data Provider는 범용적이어야 합니다.</p>
<p>Data Provider는 일반적으로 CRUD 명령을 수행합니다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dart" data-lang="dart"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DataProvider</span> {
</span></span><span style="display:flex;"><span>    Future<span style="color:#f92672">&lt;</span>RawData<span style="color:#f92672">&gt;</span> readData() <span style="color:#66d9ef">async</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Read from DB or make network request etc...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h4 id="repository">Repository</h4>
<p>Repository는 하나 또는 그 이상의 Data Provider들을 감싸서 Bloc 레이어와 통신합니다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dart" data-lang="dart"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Repository</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">final</span> DataProviderA dataProviderA;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">final</span> DataProviderB dataProviderB;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    Future<span style="color:#f92672">&lt;</span>Data<span style="color:#f92672">&gt;</span> getAllDataThatMeetsRequirements() <span style="color:#66d9ef">async</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">final</span> RawDataA dataSetA <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> dataProviderA.readData();
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">final</span> RawDataB dataSetB <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> dataProviderB.readData();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">final</span> Data filteredData <span style="color:#f92672">=</span> _filterData(dataSetA, dataSetB);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> filteredData;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="blocbusiness-logic-레이어">Bloc(Business Logic) 레이어</h3>
<blockquote>
<p>Bloc 레이어의 책임은 프리젠테이션으로부터 온 이벤트를 새 상태로 응답하는 것입니다. Bloc 레이어는 빌드에 필요한 데이터를 찾기 위해 하나 이상의 Repository를 의존합니다.</p>
</blockquote>
<p>Bloc 레이어가 UI(프리젠테이션 레이어)와 데이터 레이어를 잇는 가교 역할을 한다고 생각하세요.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dart" data-lang="dart"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">BusinessLogicComponent</span> <span style="color:#66d9ef">extends</span> Bloc {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">final</span> Repository repository;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    Stream mapEventToState(currentState, event) <span style="color:#66d9ef">async</span><span style="color:#f92672">*</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (event <span style="color:#66d9ef">is</span> AppStarted) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">yield</span> <span style="color:#66d9ef">await</span> repository.getAllDataThatMeetsRequirements();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h4 id="bloc-간의-통신">Bloc 간의 통신</h4>
<p>모든 Bloc은 다른 Bloc들이 구독할 수 있는 상태 Stream을 가집니다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dart" data-lang="dart"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MyBloc</span> <span style="color:#66d9ef">extends</span> Bloc {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">final</span> OtherBloc otherBloc;
</span></span><span style="display:flex;"><span>  StreamSubscription otherBlocSubscription;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  MyBloc(<span style="color:#66d9ef">this</span>.otherBloc) {
</span></span><span style="display:flex;"><span>    otherBlocSubscription <span style="color:#f92672">=</span> otherBloc.state.listen((state) {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// 여기서 상태 변경에 반응합니다. 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#75715e">// 여기서 MyBloc의 변경을 트리거하기 위해 이벤트를 디스패치 합니다.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    });
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#960050;background-color:#1e0010">@</span>override
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">void</span> dispose() {
</span></span><span style="display:flex;"><span>    otherBlocSubscription.cancel();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">super</span>.dispose();
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="프리젠테이션-레이어">프리젠테이션 레이어</h3>
<blockquote>
<p>프리젠테이션 레이어의 책임은 하나 이상의 bloc 상태를 기반으로 렌더링 하는 것입니다. 이것은 사용자 입력이나 앱 라이프사이클 이벤트에 의해 다뤄져야 합니다.</p>
</blockquote>
<p>아래 시나리오에서는 프리젠테이션 레이어가 <code>AppStart</code> 이벤트를 디스패치합니다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dart" data-lang="dart"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">PresentationComponent</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">final</span> Bloc bloc;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    PresentationComponent() {
</span></span><span style="display:flex;"><span>        bloc.dispatch(AppStarted());
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    build() {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// bloc 상태를 기반으로 UI를 렌더링 합니다.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="테스팅">테스팅</h2>
<blockquote>
<p>Bloc은 극도로 테스트하기 쉽게 설계됐습니다.</p>
</blockquote>
<p>CounterBloc을 위한 테스트코드를 작성해봅시다.</p>
<p>CounterBloc의 구현은 다음과 같습니다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dart" data-lang="dart"><span style="display:flex;"><span>enum CounterEvent { increment, decrement }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">CounterBloc</span> <span style="color:#66d9ef">extends</span> Bloc<span style="color:#f92672">&lt;</span>CounterEvent, <span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#960050;background-color:#1e0010">@</span>override
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">int</span> <span style="color:#66d9ef">get</span> initialState <span style="color:#f92672">=&gt;</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#960050;background-color:#1e0010">@</span>override
</span></span><span style="display:flex;"><span>  Stream<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> mapEventToState(<span style="color:#66d9ef">int</span> currentState, CounterEvent event) <span style="color:#66d9ef">async</span><span style="color:#f92672">*</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">switch</span> (event) {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">case</span> CounterEvent.decrement:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">yield</span> currentState <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">case</span> CounterEvent.increment:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">yield</span> currentState <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>pubspec.yaml에서 test 패키지를 추가합니다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">dev_dependencies</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">test</span>: <span style="color:#e6db74">&#34;&gt;=1.3.0 &lt;2.0.0&#34;</span>
</span></span></code></pre></div><p>import</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dart" data-lang="dart"><span style="display:flex;"><span><span style="color:#66d9ef">import</span> <span style="color:#e6db74">&#39;package:test/test.dart&#39;</span>;
</span></span></code></pre></div><p>먼저 테스트 그룹을 만들어야 합니다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dart" data-lang="dart"><span style="display:flex;"><span><span style="color:#66d9ef">void</span> main() {
</span></span><span style="display:flex;"><span>    group(<span style="color:#e6db74">&#39;CounterBloc&#39;</span>, () {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>group은 같은 컨텍스트 안에 여러 테스트를 묶어놓기 위해 사용합니다. 테스트들은 공통의 setUp과 tearDown을 공유합니다.</p>
<p>CounterBloc의 인스턴스를 만드는 것부터 시작합시다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dart" data-lang="dart"><span style="display:flex;"><span>group(<span style="color:#e6db74">&#39;CounterBloc&#39;</span>, () {
</span></span><span style="display:flex;"><span>    CounterBloc counterBloc;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    setUp(() {
</span></span><span style="display:flex;"><span>        counterBloc <span style="color:#f92672">=</span> CounterBloc();
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>});
</span></span></code></pre></div><p>이제 각 테스트를 작성할 수 있습니다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dart" data-lang="dart"><span style="display:flex;"><span>group(<span style="color:#e6db74">&#39;CounterBloc&#39;</span>, () {
</span></span><span style="display:flex;"><span>    CounterBloc counterBloc;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    setUp(() {
</span></span><span style="display:flex;"><span>        counterBloc <span style="color:#f92672">=</span> CounterBloc();
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    test(<span style="color:#e6db74">&#39;initial state is 0&#39;</span>, () {
</span></span><span style="display:flex;"><span>        expect(counterBloc.initialState, <span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>});
</span></span></code></pre></div><p>우리는 모든 테스트를 <code>pub run test</code> 명령으로 실행할 수 있습니다.</p>
<p>아래 코드는 더 복잡한 테스트를 작성한 예입니다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dart" data-lang="dart"><span style="display:flex;"><span>test(<span style="color:#e6db74">&#39;single Increment event updates state to 1&#39;</span>, () {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">final</span> List<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> expected <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    expectLater(
</span></span><span style="display:flex;"><span>        counterBloc.state,
</span></span><span style="display:flex;"><span>        emitsInOrder(expected),
</span></span><span style="display:flex;"><span>    );
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    counterBloc.dispatch(CounterEvent.increment);
</span></span><span style="display:flex;"><span>});
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>test(<span style="color:#e6db74">&#39;single Decrement event updates state to -1&#39;</span>, () {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">final</span> List<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> expected <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    expectLater(
</span></span><span style="display:flex;"><span>        counterBloc.state,
</span></span><span style="display:flex;"><span>        emitsInOrder(expected),
</span></span><span style="display:flex;"><span>    );
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    counterBloc.dispatch(CounterEvent.decrement);
</span></span><span style="display:flex;"><span>});
</span></span></code></pre></div>
    </div>
  </article>

  
  






  <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/posts">Posts</a></li>
         
          <li><a href="/categories">Categories</a></li>
         
          <li><a href="/tags">Tags</a></li>
        
      </ul>
    </div>

    
    <div id="toc-footer" style="display: none">
      <nav id="TableOfContents">
  <ul>
    <li><a href="#시작하기">시작하기</a>
      <ul>
        <li><a href="#개요">개요</a></li>
        <li><a href="#설치">설치</a></li>
        <li><a href="#import">Import</a></li>
      </ul>
    </li>
    <li><a href="#왜-bloc인가요">왜 Bloc인가요?</a></li>
    <li><a href="#핵심-개념">핵심 개념</a>
      <ul>
        <li><a href="#events">Events</a></li>
        <li><a href="#states">States</a></li>
        <li><a href="#transitions">Transitions</a></li>
        <li><a href="#streams">Streams</a></li>
        <li><a href="#blocs">Blocs</a></li>
        <li><a href="#blocdelegate">BlocDelegate</a></li>
      </ul>
    </li>
    <li><a href="#아키텍쳐">아키텍쳐</a>
      <ul>
        <li><a href="#데이터-레이어">데이터 레이어</a></li>
        <li><a href="#blocbusiness-logic-레이어">Bloc(Business Logic) 레이어</a></li>
        <li><a href="#프리젠테이션-레이어">프리젠테이션 레이어</a></li>
      </ul>
    </li>
    <li><a href="#테스팅">테스팅</a></li>
  </ul>
</nav>
    </div>
    

    <div id="share-footer" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=%2fposts%2f2019-03-24-flutter-bloc-introduction%2f" aria-label="Facebook">
      <i class="fab fa-facebook fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=%2fposts%2f2019-03-24-flutter-bloc-introduction%2f&text=Flutter%eb%a1%9c%20%ea%b0%9c%eb%b0%9c%ed%95%98%ea%b8%b0%2822%29%20-%20Bloc%20%ec%86%8c%ea%b0%9c" aria-label="Twitter">
      <i class="fab fa-twitter fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=%2fposts%2f2019-03-24-flutter-bloc-introduction%2f&title=Flutter%eb%a1%9c%20%ea%b0%9c%eb%b0%9c%ed%95%98%ea%b8%b0%2822%29%20-%20Bloc%20%ec%86%8c%ea%b0%9c" aria-label="Linkedin">
      <i class="fab fa-linkedin fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=%2fposts%2f2019-03-24-flutter-bloc-introduction%2f&is_video=false&description=Flutter%eb%a1%9c%20%ea%b0%9c%eb%b0%9c%ed%95%98%ea%b8%b0%2822%29%20-%20Bloc%20%ec%86%8c%ea%b0%9c" aria-label="Pinterest">
      <i class="fab fa-pinterest fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=Flutter%eb%a1%9c%20%ea%b0%9c%eb%b0%9c%ed%95%98%ea%b8%b0%2822%29%20-%20Bloc%20%ec%86%8c%ea%b0%9c&body=Check out this article: %2fposts%2f2019-03-24-flutter-bloc-introduction%2f" aria-label="Email">
      <i class="fas fa-envelope fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=%2fposts%2f2019-03-24-flutter-bloc-introduction%2f&title=Flutter%eb%a1%9c%20%ea%b0%9c%eb%b0%9c%ed%95%98%ea%b8%b0%2822%29%20-%20Bloc%20%ec%86%8c%ea%b0%9c" aria-label="Pocket">
      <i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=%2fposts%2f2019-03-24-flutter-bloc-introduction%2f&title=Flutter%eb%a1%9c%20%ea%b0%9c%eb%b0%9c%ed%95%98%ea%b8%b0%2822%29%20-%20Bloc%20%ec%86%8c%ea%b0%9c" aria-label="reddit">
      <i class="fab fa-reddit fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=%2fposts%2f2019-03-24-flutter-bloc-introduction%2f&name=Flutter%eb%a1%9c%20%ea%b0%9c%eb%b0%9c%ed%95%98%ea%b8%b0%2822%29%20-%20Bloc%20%ec%86%8c%ea%b0%9c&description=Bloc%20document%20-%20%ec%86%8c%ea%b0%9c%20%ec%9b%90%eb%ac%b8%3a%20https%3a%2f%2ffelangel.github.io%2fbloc%0a%ec%8b%9c%ec%9e%91%ed%95%98%ea%b8%b0%20%ea%b0%9c%ec%9a%94%20Bloc%ec%9d%80%20%ec%84%b8%20%ea%b0%80%ec%a7%80%20%ed%8c%a8%ed%82%a4%ec%a7%80%eb%a1%9c%20%ea%b5%ac%ec%84%b1%eb%90%a9%eb%8b%88%eb%8b%a4.%0abloc%20-%20%ec%bd%94%ec%96%b4%20%eb%9d%bc%ec%9d%b4%eb%b8%8c%eb%9f%ac%eb%a6%ac%20flutter_bloc%20-%20bloc%ec%9d%84%20%ec%82%ac%ec%9a%a9%ed%95%98%ea%b8%b0%20%ec%9c%84%ed%95%9c%20%ed%94%8c%eb%9f%ac%ed%84%b0%20%ec%9c%84%ec%a0%af%20angular_bloc%20-%20bloc%ec%9d%84%20%ec%82%ac%ec%9a%a9%ed%95%98%ea%b8%b0%20%ec%9c%84%ed%95%9c%20%ec%95%b5%ea%b7%a4%eb%9f%ac%20%ec%bb%b4%ed%8f%ac%eb%84%8c%ed%8a%b8%20%ec%84%a4%ec%b9%98%20%ed%94%8c%ed%84%b0%ed%84%b0%ec%9d%98%20%ea%b2%bd%ec%9a%b0%20pubspec.yaml%ec%97%90%ec%84%9c%0adependencies%3a%20bloc%3a%20%5e0.10.0%20flutter_bloc%3a%20%5e0.8.0%20%ea%b7%b8%eb%a6%ac%ea%b3%a0%20flutter%20packages%20get%0aImport%20%ed%94%8c%eb%9f%ac%ed%84%b0%ec%9d%98%20%ea%b2%bd%ec%9a%b0%0aimport%20%26%2339%3bpackage%3abloc%2fbloc.dart%26%2339%3b%3b%20import%20%26%2339%3bpackage%3aflutter_bloc%2fflutter_bloc.dart%26%2339%3b%3b%20%ec%99%9c%20Bloc%ec%9d%b8%ea%b0%80%ec%9a%94%3f%20Bloc%ec%9d%80%20%eb%b9%84%ec%a7%80%eb%8b%88%ec%8a%a4%20%eb%a1%9c%ec%a7%81%ec%9c%bc%eb%a1%9c%eb%b6%80%ed%84%b0%20%ed%94%84%eb%a6%ac%ec%a0%a0%ed%85%8c%ec%9d%b4%ec%85%98%20%eb%a1%9c%ec%a7%81%ec%9d%84%20%ec%89%bd%ea%b2%8c%20%eb%b6%84%eb%a6%ac%ec%8b%9c%ec%bc%9c%ec%a4%8d%eb%8b%88%eb%8b%a4.%20%eb%b9%a0%eb%a5%b4%ea%b2%8c%20%ec%9e%91%ec%84%b1%ed%95%a0%20%ec%88%98%20%ec%9e%88%eb%8a%94%20%ec%bd%94%eb%93%9c%2c%20%ec%89%bd%ea%b2%8c%20%ed%85%8c%ec%8a%a4%ed%8a%b8%20%ed%95%a0%20%ec%88%98%20%ec%9e%88%eb%8a%94%20%ec%bd%94%eb%93%9c%2c%20%ec%9e%ac%ec%82%ac%ec%9a%a9%20%ea%b0%80%eb%8a%a5%ed%95%9c%20%ec%bd%94%eb%93%9c%eb%a5%bc%20%eb%a7%8c%eb%93%a4%20%ec%88%98%20%ec%9e%88%ea%b2%8c%20%ed%95%b4%ec%a4%8d%eb%8b%88%eb%8b%a4." aria-label="Tumblr">
      <i class="fab fa-tumblr fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=%2fposts%2f2019-03-24-flutter-bloc-introduction%2f&t=Flutter%eb%a1%9c%20%ea%b0%9c%eb%b0%9c%ed%95%98%ea%b8%b0%2822%29%20-%20Bloc%20%ec%86%8c%ea%b0%9c" aria-label="Hacker News">
      <i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>

    <div id="actions-footer">
      
        <a id="menu-toggle" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;" aria-label="Menu">
          <i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
        <a id="toc-toggle" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;" aria-label="TOC">
          <i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share-toggle" class="icon" href="#" onclick="$('#share-footer').toggle();return false;" aria-label="Share">
          <i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" aria-label="Top of Page">
          <i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>


  <footer id="footer">
  <div class="footer-left">
    Copyright  &copy; 2022  Booseol Shin 
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
        <li><a href="/posts">Posts</a></li>
         
        <li><a href="/categories">Categories</a></li>
         
        <li><a href="/tags">Tags</a></li>
        
      </ul>
    </nav>
  </div>
</footer>


  </div>
</body>

<link rel="stylesheet" href=/lib/font-awesome/css/all.min.css>
<script src=/lib/jquery/jquery.min.js></script>
<script src=/js/main.js></script>

<script src=/js/code-copy.js></script>




</html>
